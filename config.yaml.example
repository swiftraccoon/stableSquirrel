# Stable Squirrel Configuration
# Copy this file to config.yaml and modify for your setup

# =============================================================================
# INGESTION SETTINGS - RdioScanner API and Security
# =============================================================================
ingestion:
  # API Authentication (choose one approach)
  # Option 1: Simple single API key (legacy, but still supported)
  api_key: "change-this-to-a-secure-key-at-least-16-chars"
  
  # Option 2: Enhanced API keys with restrictions (recommended)
  api_keys:
    - key: "primary-station-secure-key-32-chars"
      description: "Main monitoring station"
      allowed_ips: ["192.168.1.100"]      # Optional: restrict to specific IPs
      allowed_systems: ["system-001"]      # Optional: restrict to specific systems
    
    - key: "mobile-unit-different-key-32-chars"
      description: "Mobile monitoring unit"
      # No IP restrictions for mobile units
      allowed_systems: ["mobile-001", "mobile-002"]
  
  # File Processing
  polling_interval: 1.0                    # Seconds between checking for new files
  supported_formats: [".mp3"]              # Only MP3 is supported (SDRTrunk standard)
  
  # Security Settings
  enable_file_validation: true             # Enable file security checks
  max_file_size_mb: 100                    # Maximum upload size in MB
  min_file_size_kb: 1                      # Minimum upload size in KB
  max_uploads_per_minute: 10               # Rate limit per IP address
  max_uploads_per_hour: 100                # Hourly rate limit per IP
  
  # Upload Tracking
  track_upload_sources: true               # Track which systems upload files
  require_system_id: true                  # Require system ID parameter
  log_all_uploads: false                   # Log all upload attempts (verbose)
  security_event_retention_days: 365       # How long to keep security events

# =============================================================================
# TRANSCRIPTION SETTINGS - WhisperX Configuration
# =============================================================================
transcription:
  # Model Configuration
  model_name: "base"                       # Options: tiny, base, small, medium, large, large-v2, large-v3
  device: "auto"                           # auto, cpu, or cuda
  language: null                           # null for auto-detect, or "en", "es", etc.
  
  # Processing Settings
  batch_size: 16                           # Reduce if getting out-of-memory errors
  enable_diarization: true                 # Enable speaker identification
  
  # Performance Optimization
  queue_size: 10000                        # Maximum pending transcriptions
  num_workers: 4                           # Parallel transcription workers
  max_file_size_mb: 100                    # Maximum audio file size
  cleanup_interval_minutes: 5              # Temp file cleanup interval
  
  # Advanced Model Settings
  compute_type: "auto"                     # auto, float16 (GPU), or int8 (CPU)
  chunk_length: 30                         # Audio chunk length in seconds
  use_pipeline_cache: true                 # Cache model for faster processing

# =============================================================================
# DATABASE SETTINGS - PostgreSQL/TimescaleDB
# =============================================================================
database:
  # Connection Settings
  host: "localhost"
  port: 5432
  database: "stable_squirrel"
  username: "stable_squirrel"
  password: "changeme"                     # CHANGE THIS!
  
  # Connection Pooling
  min_pool_size: 5                         # Minimum database connections
  max_pool_size: 20                        # Maximum database connections
  
  # Schema Management
  create_tables: true                      # Auto-create tables on startup
  enable_timescale: true                   # Enable TimescaleDB extensions

# =============================================================================
# WEB SERVER SETTINGS - API Configuration
# =============================================================================
web:
  # Server Binding
  host: "0.0.0.0"                          # 0.0.0.0 = all interfaces, 127.0.0.1 = localhost only
  port: 8000
  
  # CORS Settings
  cors_origins: ["*"]                      # Allowed origins (* = all, restrict in production)
  
  # Documentation
  enable_docs: true                        # Enable Swagger UI at /docs

# =============================================================================
# ALERTS - Email Notifications (Not Yet Implemented)
# =============================================================================
alerts:
  enabled: false                           # Alert system not implemented yet
  # smtp_host: "smtp.gmail.com"
  # smtp_port: 587
  # smtp_username: "your-email@gmail.com"
  # smtp_password: "your-app-password"